read_excel("dados_frota/frotas2000_2021/frota2002.xls", range = "B7:W38")
read_excel("dados_frota/frotas2000_2021/frota2002.xls", range = "B7:W38") |> view()
read_excel("dados_frota/frotas2000_2021/frota2002.xls", range = "B7:W38") |> view()
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
return()
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
return()
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
return(aux)
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux)
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux)
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 3
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 3
exemplo <- enderecos_frota[num] |> import_frota2()
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 1
exemplo <- enderecos_frota[num] |> import_frota2()
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
return(read_excel(endereco, sheet = 1, range = "B36:W38"))
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 1
exemplo <- enderecos_frota[num] |> import_frota2()
View(exemplo)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 2
exemplo <- enderecos_frota[num] |> import_frota2()
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 1
exemplo <- enderecos_frota[num] |> import_frota2()
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
return(read_excel(endereco, sheet = 1, range = "B42:W43"))
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR", "CAMINHONETE",
"CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIOS")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
num <- 1
exemplo <- enderecos_frota[num] |> import_frota2()
