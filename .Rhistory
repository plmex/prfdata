frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 18
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 19
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 20
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 21
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 22
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 22
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
nomes <- df_temp |> colnames() |> toupper()
print(nomes)
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
View(resultado)
num <- 5
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
nomes <- df_temp |> colnames() |> toupper()
print(nomes)
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 5
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
num <- 6
exemplo <- enderecos_frota[num] |> import_frota2()
# frota_extract <- function(df){
#   result <- df |>
#     mutate(
#     automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
#     motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
#     total = TOTAL
#   ) |>
#   select(
#     automovel,
#     motocicleta,
#     total
#   )
# }
frota_extract <- function(df){
# transforma dados em númerico caso estejam em formato de carácter
df_temp <- as.data.frame(lapply(df, as.numeric))
res <- df_temp |>
mutate(
automovel = AUTOMÓVEL + CAMINHONETE + CAMIONETA + UTILITÁRIO,
motocicleta = MOTOCICLETA + MOTONETA + CICLOMOTOR,
total = TOTAL
) |>
select(
automovel,
motocicleta,
total
)
return(res)
}
resultado <- frota_extract(exemplo)
aux <- read_excel(endereco, sheet = 1, range = "B42:W43")
aux <- read_excel(enderecos_frota[5], sheet = 1, range = "B42:W43")
View(aux)
aux <- read_excel(enderecos_frota[5], sheet = 1, range = "B42:W43") |> toupper()
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
aux <- read_excel(endereco, sheet = 1, range = "B42:W43")
return(aux)
}
else if (str_sub(endereco,34,37) == "2003") {
# foi necessário alterar o formato da planilha de .xls para .xlsx e excluir planilhas vazias para 2003
# também é feito um subset da planilha
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"TOTAL", "AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR",
"CAMINHONETE", "CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIO")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
import_frota2(enderecos_frota[5])
sla<-import_frota2(enderecos_frota[5])
View(sla)
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
aux <- read_excel(endereco, sheet = 1, range = "B42:W43")
# correção de labels das colunas
nomes <- aux |>
colnames() |>
toupper()
print(nomes)
return(aux)
}
else if (str_sub(endereco,34,37) == "2003") {
# precisou alterar o formato da planilha de .xls para .xlsx
# e excluir páginas vazias
# também é feito um subset da planilha para coletar só os totais
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"TOTAL", "AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR",
"CAMINHONETE", "CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIO")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
import_frota2(enderecos_frota[5])
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
aux <- read_excel(endereco, sheet = 1, range = "B42:W43")
# correção de labels das colunas
nomes <- aux |>
colnames() |>
toupper()
if ("UTILITARIO" %in% nomes) {
replace(nomes,"UTILITARIO","UTILITÁRIO")
}
print(nomes)
return(aux)
}
else if (str_sub(endereco,34,37) == "2003") {
# precisou alterar o formato da planilha de .xls para .xlsx
# e excluir páginas vazias
# também é feito um subset da planilha para coletar só os totais
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"TOTAL", "AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR",
"CAMINHONETE", "CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIO")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
import_frota2(enderecos_frota[5])
View(frota_anos)
?replace
ue
replace(ue,10,12)
replace(ue,10,12)
ue
import_frota2 <- function(endereco) {
frota <- tryCatch(
read_excel(endereco, sheet = 2, range = "B41:W42"),
error = function(e) {
if (str_sub(endereco,34,37) %in% c("2005","2004")) {
aux <- read_excel(endereco, sheet = 1, range = "B42:W43")
# correção de labels das colunas
nomes <- aux |>
colnames() |>
toupper()
if ("UTILITARIO" %in% nomes) {
nomes <- replace(nomes,"UTILITARIO","UTILITÁRIO")
}
print(nomes)
return(aux)
}
else if (str_sub(endereco,34,37) == "2003") {
# precisou alterar o formato da planilha de .xls para .xlsx
# e excluir páginas vazias
# também é feito um subset da planilha para coletar só os totais
aux <- read_excel(endereco, sheet = 1, range = "B3:W33")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2002") {
aux <- read_excel(endereco, sheet = 1, range = "B7:W38")
colnames(aux) <- c(
"TOTAL", "AUTOMÓVEL", "BONDE", "CAMINHÃO", "CAMINHÃO TRATOR",
"CAMINHONETE", "CAMIONETA", "CHASSI PLATAF", "CICLOMOTOR", "MICROÔNIBUS",
"MOTOCICLETA", "MOTONETA", "ÔNIBUS", "QUADRICICLO", "REBOQUE",
"SEMIREBOQUE", "SIDECAR", "OUTROS", "TRATOR ESTEI", "TRATOR RODAS",
"TRICICLO","UTILITÁRIO")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2001") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W38")
return(aux[nrow(aux),])
}
else if (str_sub(endereco,34,37) == "2000") {
aux <- read_excel(endereco, sheet = 1, range = "B36:W37")
return(aux[nrow(aux),])
}
else {
return(read_excel(endereco, sheet = 1, range = "B41:W42"))
}
}
)
return(frota)
}
import_frota2(enderecos_frota[5])
frota2004 <- read_excel(enderecos_frota[5], sheet = 1, range = "B42:W43")
View(frota2004)
colnames(frota2004)
colnames(frota2004) |> toupper() |> replace("UTILITARIO","UTILITÁRIO")
sla<-colnames(frota2004) |> toupper() |> replace("UTILITARIO","UTILITÁRIO")
sla
